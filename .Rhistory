geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$Experience, main="Q-Q plot of Experience level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Experience, col = 'red')
str(loandata)
ggplot(data=not_defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..), binwidth = 4,
col="gold4",
fill="gold2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Experience), sd = sd(not_defaulted$Experience))) +
labs(title="Non-defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
ggplot(not_defaulted, aes(y=Experience)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$Experience, main="Q-Q plot of Experience level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Experience, col = 'red')
ggplot(data=not_defaulted, aes(CURRENT_JOB_YRS)) +
geom_histogram(aes(y=..density..), binwidth = 1,
col="burlywood4",
fill="burlywood2",
alpha = .7) +
labs(title="Non-defaulted Years in Current Job Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE), sd = sd(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE))) +
labs(x="Years in Current Job", y="Frequency")
ggplot(not_defaulted, aes(y=CURRENT_JOB_YRS)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Years in Current Job boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$CURRENT_JOB_YRS, main="Q-Q plot of Years in Current Job,level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$CURRENT_JOB_YRS, col = 'red')
ggplot(data=defaulted, aes(Age)) +
geom_histogram(aes(y=..density..),
binwidth = 10,
col="darkolivegreen4",
fill="darkolivegreen2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Age, na.rm = TRUE), sd = sd(defaulted$Age, na.rm = TRUE))) + # opacity
labs(title="Defaulted Customers Age Histogram") +
labs(x="Age", y="Frequency")
qqnorm(defaulted$Age, main="Q-Q plot of Age Defaulted Customers", col = 'royalblue2' )
qqline(defaulted$Age, col = 'red')
ggplot(defaulted, aes(y=Income)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
ggplot(data=defaulted, aes(Income)) +
geom_histogram(aes(y=..density..),
col="darkblue",
fill="cornflowerblue",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Income, na.rm = TRUE), sd = sd(defaulted$Income, na.rm = TRUE))) +
labs(title="defaulted Customers Income Histogram") +
labs(x="Income", y="Frequency")
qqnorm(defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
ggplot(data=defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..),
binwidth = 5,
col="darkorange4",
fill="darkorange2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Experience, na.rm = TRUE), sd = sd(defaulted$Experience, na.rm = TRUE))) +
labs(title="defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
ggplot(defaulted, aes(y=Experience)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$Experience, main="Q-Q plot of Years of Experience of Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
ggplot(data=defaulted, aes(CURRENT_HOUSE_YRS)) +
geom_histogram(aes(y=..density..),
binwidth = 1,
col="ivory4",
fill="ivory2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE), sd = sd(defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE))) +
labs(title="defaulted Years in Current Home Histogram") +
labs(x="Experience", y="Frequency")
ggplot(defaulted, aes(y=CURRENT_HOUSE_YRS)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Defaulted Customer Years in Current Home boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$CURRENT_HOUSE_YRS, main="Q-Q plot of Years in Current Home, for Defaulted Customers", col = 'royalblue2')
qqline(defaulted$CURRENT_HOUSE_YRS, col = 'red')
ggplot(data=defaulted, aes(CURRENT_JOB_YRS)) +
geom_histogram(aes(y=..density..),
binwidth = 1,
col="lightpink4",
fill="lightpink2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$CURRENT_JOB_YRS, na.rm = TRUE), sd = sd(defaulted$CURRENT_JOB_YRS, na.rm = TRUE))) +
labs(title="defaulted - Years in Current Job Histogram") +
labs(x="Experience", y="Frequency")
ggplot(defaulted, aes(y=CURRENT_JOB_YRS)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Defaulted Customer Years in Current Job boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$CURRENT_JOB_YRS, main="Q-Q plot of Years in Current Job, for Defaulted Customers", col = 'royalblue2')
qqline(defaulted$CURRENT_JOB_YRS, col = 'red')
ggplot(loandata, aes(x=Risk_Flag, y=Age)) +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4)+
labs(title="Age based on Loan Default Status",x="Default Status", y = "Age")
ggplot(loandata, aes(x=Risk_Flag, y=Experience)) +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4)+
labs(title="Years Overall Job Experience based on Loan Default Status",x="Default Status", y = "Total Job Experience")
ggplot(loandata, aes(x=Risk_Flag, y=CURRENT_HOUSE_YRS)) +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4)+
labs(title="Years in Current House based on Loan Default Status",x="Default Status", y = "Years in Current House")
ggplot(not_defaulted, aes(y=Income)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
ggplot(data=not_defaulted, aes(Income)) +
geom_histogram(aes(y=..density..),
col="dodgerblue4",
fill="dodgerblue2",
alpha = .7) +
labs(title="Non-defaulted Customers Income Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Income, na.rm = TRUE), sd = sd(not_defaulted$Income, na.rm = TRUE))) +
labs(x="Income", y="Frequency")
qqnorm(not_defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Income, col = 'red')
ggplot(not_defaulted, aes(y=Income)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
# ggplot(data=not_defaulted, aes(Income)) +
#   geom_histogram(aes(y=..density..),
#
#                  col="dodgerblue4",
#                  fill="dodgerblue2",
#                  alpha = .7) +
#   labs(title="Non-defaulted Customers Income Histogram") +
#   stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Income, na.rm = TRUE), sd = sd(not_defaulted$Income, na.rm = TRUE))) +
#   labs(x="Income", y="Frequency")
qqnorm(not_defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Income, col = 'red')
ggplot(not_defaulted, aes(y=Income)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Not_Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
# ggplot(data=not_defaulted, aes(Income)) +
#   geom_histogram(aes(y=..density..),
#
#                  col="dodgerblue4",
#                  fill="dodgerblue2",
#                  alpha = .7) +
#   labs(title="Non-defaulted Customers Income Histogram") +
#   stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Income, na.rm = TRUE), sd = sd(not_defaulted$Income, na.rm = TRUE))) +
#   labs(x="Income", y="Frequency")
qqnorm(not_defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Income, col = 'red')
# ggplot(not_defaulted, aes(y=Income)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
ggplot(data=not_defaulted, aes(Income)) +
geom_histogram(aes(y=..density..),
col="dodgerblue4",
fill="dodgerblue2",
alpha = .7) +
labs(title="Non-defaulted Customers Income Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Income, na.rm = TRUE), sd = sd(not_defaulted$Income, na.rm = TRUE))) +
labs(x="Income", y="Frequency")
qqnorm(not_defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Income, col = 'red')
#str(loandata)
ggplot(data=not_defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..), binwidth = 4,
col="gold4",
fill="gold2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Experience), sd = sd(not_defaulted$Experience))) +
labs(title="Non-defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(not_defaulted, aes(y=Experience)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$Experience, main="Q-Q plot of Experience level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Experience, col = 'red')
ggplot(data=not_defaulted, aes(CURRENT_HOUSE_YRS)) +
geom_histogram(aes(y=..density..), binwidth = 1,
col="brown4",
fill="brown2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE), sd = sd(not_defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE))) +
labs(title="Non-defaulted Customers years in Current Home Histogram") +
labs(x='Years in Current Home', y="Frequency")
# ggplot(not_defaulted, aes(y=CURRENT_HOUSE_YRS)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Customer Years in Current Home boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$CURRENT_HOUSE_YRS, main="Q-Q plot of Years in Current Home level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$CURRENT_HOUSE_YRS, col = 'red')
ggplot(data=not_defaulted, aes(CURRENT_JOB_YRS)) +
geom_histogram(aes(y=..density..), binwidth = 1,
col="burlywood4",
fill="burlywood2",
alpha = .7) +
labs(title="Non-defaulted Years in Current Job Years Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE), sd = sd(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE))) +
labs(x="Years in Current Job", y="Frequency")
# ggplot(not_defaulted, aes(y=CURRENT_JOB_YRS)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Years in Current Job boxplot ",x="", y = "weight (lbs)")
#
qqnorm(not_defaulted$CURRENT_JOB_YRS, main="Q-Q plot of Years in Current Job,level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$CURRENT_JOB_YRS, col = 'red')
ggplot(defaulted, aes(y=Income)) +
geom_boxplot() +
geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
labs(title="Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
# ggplot(data=defaulted, aes(Income)) +
#   geom_histogram(aes(y=..density..),
#                  col="darkblue",
#                  fill="cornflowerblue",
#                  alpha = .7) +
#   stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Income, na.rm = TRUE), sd = sd(defaulted$Income, na.rm = TRUE))) +
#   labs(title="defaulted Customers Income Histogram") +
#   labs(x="Income", y="Frequency")
qqnorm(defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
ggplot(data=defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..),
binwidth = 5,
col="darkorange4",
fill="darkorange2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Experience, na.rm = TRUE), sd = sd(defaulted$Experience, na.rm = TRUE))) +
labs(title="defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(defaulted, aes(y=Experience)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$Experience, main="Q-Q plot of Years of Experience of Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
ggplot(data=defaulted, aes(CURRENT_HOUSE_YRS)) +
geom_histogram(aes(y=..density..),
binwidth = 1,
col="ivory4",
fill="ivory2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE), sd = sd(defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE))) +
labs(title="defaulted Years in Current Home Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(defaulted, aes(y=CURRENT_HOUSE_YRS)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Years in Current Home boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$CURRENT_HOUSE_YRS, main="Q-Q plot of Years in Current Home, for Defaulted Customers", col = 'royalblue2')
qqline(defaulted$CURRENT_HOUSE_YRS, col = 'red')
ggplot(data=defaulted, aes(CURRENT_JOB_YRS)) +
geom_histogram(aes(y=..density..),
binwidth = 1,
col="lightpink4",
fill="lightpink2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$CURRENT_JOB_YRS, na.rm = TRUE), sd = sd(defaulted$CURRENT_JOB_YRS, na.rm = TRUE))) +
labs(title="defaulted - Years in Current Job Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(defaulted, aes(y=CURRENT_JOB_YRS)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Years in Current Job boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$CURRENT_JOB_YRS, main="Q-Q plot of Years in Current Job, for Defaulted Customers", col = 'royalblue2')
qqline(defaulted$CURRENT_JOB_YRS, col = 'red')
str(loandata)
# ggplot(defaulted, aes(y=Income)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
ggplot(data=defaulted, aes(Income)) +
geom_histogram(aes(y=..density..),
col="darkblue",
fill="cornflowerblue",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Income, na.rm = TRUE), sd = sd(defaulted$Income, na.rm = TRUE))) +
labs(title="defaulted Customers Income Histogram") +
labs(x="Income", y="Frequency")
qqnorm(defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
# ggplot(defaulted, aes(y=Income)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Income boxplot ",x="", y = "weight (lbs)")
ggplot(data=defaulted, aes(Income)) +
geom_histogram(aes(y=..density..),
col="magenta4",
fill="magenta2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Income, na.rm = TRUE), sd = sd(defaulted$Income, na.rm = TRUE))) +
labs(title="defaulted Customers Income Histogram") +
labs(x="Income", y="Frequency")
qqnorm(defaulted$Income, main="Q-Q plot of Income level of Not Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Income, col = 'red')
ggplot(data=defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..),
binwidth = 5,
col="darkorange4",
fill="darkorange2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Experience, na.rm = TRUE), sd = sd(defaulted$Experience, na.rm = TRUE))) +
labs(title="defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(defaulted, aes(y=Experience)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$Experience, main="Q-Q plot of Years of Experience of Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Experience, col = 'red')
shapiro.test(not_defaulted$Age)
#str(loandata)
ggplot(data=not_defaulted, aes(Age)) +
geom_histogram(aes(y=..density..), binwidth = 10,
col="aquamarine4",
fill="aquamarine2",
alpha = .7) +
labs(title="Non-defaulted Customers Age Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Age, na.rm = TRUE), sd = sd(not_defaulted$Age, na.rm = TRUE))) +
labs(x="Age", y="Frequency")
qqnorm(not_defaulted$Age, main="Q-Q plot of Age level of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Age, col = 'red')
##shapiro.test(not_defaulted$Age) sample size to big to conduct a shapiro test
sum(is.na(loandata$Age))
sum(is.na(loandata$Income))
sum(is.na(loandata$Experience))
sum(is.na(loandata$Married.Single))
sum(is.na(loandata$House_Ownership))
sum(is.na(loandata$Car_Ownership))
sum(is.na(loandata$CURRENT_HOUSE_YRS))
sum(is.na(loandata$CURRENT_JOB_YRS))
sum(is.na(loandata$Income))
outlierKD2(defaulted, Age, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(defaulted, Income, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(defaulted, Experience, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(defaulted, CURRENT_JOB_YRS, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(not_defaulted, Age, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(not_defaulted, Income, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(not_defaulted, Experience, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
outlierKD2(not_defaulted, CURRENT_JOB_YRS, rm=TRUE, boxplt=TRUE, histogram=TRUE, qqplt=TRUE)
str(loandata)
#str(loandata)
ggplot(data=defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..),
binwidth = 5,
col="darkorange4",
fill="darkorange2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(defaulted$Experience, na.rm = TRUE), sd = sd(defaulted$Experience, na.rm = TRUE))) +
labs(title="defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(defaulted, aes(y=Experience)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(defaulted$Experience, main="Q-Q plot of Years of Experience of Defaulted Customers", col = 'royalblue2')
qqline(defaulted$Experience, col = 'red')
qqnorm(defaulted$Experience, main="Q-Q plot of Years of Job Experience of Defaulted Customers", col = 'royalblue2')
qqnorm(not_defaulted$CURRENT_HOUSE_YRS, main="Q-Q plot of Years in Current Home of Not Defaulted Customers", col = 'seagreen3')
ggplot(data=not_defaulted, aes(CURRENT_HOUSE_YRS)) +
geom_histogram(aes(y=..density..), binwidth = 1,
col="brown4",
fill="brown2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE), sd = sd(not_defaulted$CURRENT_HOUSE_YRS, na.rm = TRUE))) +
labs(title="Non-defaulted Customers years in Current Home Histogram") +
labs(x='Years in Current Home', y="Frequency")
# ggplot(not_defaulted, aes(y=CURRENT_HOUSE_YRS)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Customer Years in Current Home boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$CURRENT_HOUSE_YRS, main="Q-Q plot of Years in Current Home of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$CURRENT_HOUSE_YRS, col = 'red')
qqnorm(not_defaulted$Experience, main="Q-Q plot of Job Experience of Not Defaulted Customers", col = 'seagreen3')
#str(loandata)
ggplot(data=not_defaulted, aes(Experience)) +
geom_histogram(aes(y=..density..), binwidth = 4,
col="gold4",
fill="gold2",
alpha = .7) +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$Experience), sd = sd(not_defaulted$Experience))) +
labs(title="Non-defaulted Experience Histogram") +
labs(x="Experience", y="Frequency")
# ggplot(not_defaulted, aes(y=Experience)) +
#   geom_boxplot() +
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Not_Defaulted Customer Experience boxplot ",x="", y = "weight (lbs)")
qqnorm(not_defaulted$Experience, main="Q-Q plot of Job Experience of Not Defaulted Customers", col = 'seagreen3')
qqline(not_defaulted$Experience, col = 'red')
knitr::opts_chunk$set(echo = TRUE)
ggplot(data=not_defaulted, aes(CURRENT_JOB_YRS)) +
geom_histogram(aes(y=..density..), binwidth = 1,
col="burlywood4",
fill="burlywood2",
alpha = .7) +
labs(title="Non-defaulted Years in Current Job Histogram") +
stat_function(fun=dnorm, lwd = 1, col = 'red', args = list(mean = mean(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE), sd = sd(not_defaulted$CURRENT_JOB_YRS, na.rm = TRUE))) +
labs(x="Years in Current Job", y="Frequency")
$\$$`r round(min(loanpredict$Income)*0.013, digits=2)`
`r round(min(loanpredict$Income)*0.013, digits=2)`
r round(min(loanpredict$Income)*0.013, digits=2)
r round(max(loanpredict$Income)*0.013, digits=2)
round(max(loanpredict$Income)*0.013, digits=2)
r format(ttest2sample_experience$p.value, scientific=TRUE, digits = 3)
format(ttest2sample_experience$p.value, scientific=TRUE, digits = 3)
ttest2sample_experience <- t.test(defaulted$Experience, not_defaulted$Experience, alternative = "two.sided")
#Output results
ttest2sample_experience
format(ttest2sample_experience$p.value, scientific=TRUE, digits = 3)
contable_marital = table(loandata$Married.Single, loandata$Risk_Flag)
xkabledply(contable_marital, title = 'Contigency table for Risk Flag vs Marital Status ')
#contigeny table
contable_housing = table(loandata$House_Ownership, loandata$Risk_Flag)
xkabledply(contable_housing, title = 'Contigency table for Risk Flag vs House Ownership ')
chisq.test(contable_housing)
contable_marital = table(loandata$Married.Single, loandata$Risk_Flag)
xkabledply(contable_marital, title = 'Contigency table for Risk Flag vs Marital Status ')
#Remove variables that won't help in our analysis
loandata <- subset(loanpredict, select = -c(Id, CITY, STATE, Profession))
#Create summary table of remaining variables
xkablesummary(loandata, title = "Summary Statistics for Loan Default Prediction")
# some of common options (and the defaults) are:
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right',
library(ezids)
library(dplyr)
library(lmtest)
library(vcd)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3)
# options(scipen=9, digits = 3)
# use scipen=999 to prevent scientific notation at all times
#Import dataset
loanpredict <- read.csv("Training Data.csv", header = TRUE)
str(loanpredict)
#Convert necessary variables to factors/categoricals and set appropriate level titles
loanpredict$Married.Single <- recode_factor(loanpredict$Married.Single, single = "Single", married = "Married")
loanpredict$House_Ownership <- recode_factor(loanpredict$House_Ownership, rented = "Renting", owned = "Owning", norent_noown = "Neither")
loanpredict$Car_Ownership <- recode_factor(loanpredict$Car_Ownership, no = "No", yes = "Yes")
str(loanpredict)
names(loanpredict)
loandata <- subset(loanpredict, select = -c(Id, CITY, STATE, Profession))
xkablesummary(loandata, title = "Summary Statistics for Loan Default Prediction")
str(loandata)
#Summary for non-defaulted customers
xkablesummary(not_defaulted, title = "Summary of Data for Non-Defaulted Customers")
knitr::opts_chunk$set(echo = TRUE)
# some of common options (and the defaults) are:
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right',
library(ezids)
loanpredict$Car_Ownership <- recode_factor(loanpredict$Car_Ownership, no = "No", yes = "Yes")
loanpredict$House_Ownership <- recode_factor(loanpredict$House_Ownership, rented = "Renting", owned = "Owning", norent_noown = "Neither")
#Import dataset
loanpredict <- read.csv("Training Data.csv", header = TRUE)
str(loanpredict)
#Convert necessary variables to factors/categoricals and set appropriate level titles
loanpredict$Married.Single <- recode_factor(loanpredict$Married.Single, single = "Single", married = "Married")
knitr::opts_chunk$set(echo = TRUE)
# some of common options (and the defaults) are:
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right',
library(ezids)
library(dplyr)
library(lmtest)
library(vcd)
# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3)
# options(scipen=9, digits = 3)
# use scipen=999 to prevent scientific notation at all times
#Import dataset
loanpredict <- read.csv("Training Data.csv", header = TRUE)
#Convert necessary variables to factors/categoricals and set appropriate level titles
loanpredict$Married.Single <- recode_factor(loanpredict$Married.Single, single = "Single", married = "Married")
loanpredict$House_Ownership <- recode_factor(loanpredict$House_Ownership, rented = "Renting", owned = "Owning", norent_noown = "Neither")
loanpredict$Car_Ownership <- recode_factor(loanpredict$Car_Ownership, no = "No", yes = "Yes")
#Remove variables that won't help in our analysis
loandata <- subset(loanpredict, select = -c(Id, CITY, STATE, Profession))
#Selecting only values where the customer defaulted
defaulted <- subset(loandata, Risk_Flag == 1)
#Selecting only values where the customer did not default
not_defaulted <- subset(loandata, Risk_Flag == 0)
#Import necessary library
library(corrplot)
#Subset out numerical variables for correlation analysis
numericalloan <- subset(loandata, select = c(Income, Age, Experience, CURRENT_JOB_YRS, CURRENT_HOUSE_YRS, Risk_Flag))
str(loandata)
sum(is.na(loandata$Age))
sum(is.na(loandata$Income))
sum(is.na(loandata$Experience))
sum(is.na(loandata$Married.Single))
sum(is.na(loandata$House_Ownership))
sum(is.na(loandata$Car_Ownership))
sum(is.na(loandata$CURRENT_HOUSE_YRS))
sum(is.na(loandata$CURRENT_JOB_YRS))
sum(is.na(loandata$Income))
#outlierKD2(defaulted, Age, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(defaulted, Income, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(defaulted, Experience, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(defaulted, CURRENT_JOB_YRS, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(not_defaulted, Age, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(not_defaulted, Income, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(not_defaulted, Experience, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#outlierKD2(not_defaulted, CURRENT_JOB_YRS, rm=TRUE, boxplt=FALSE, histogram=FALSE, qqplt=FALSE)
#Create summary table of remaining variables
xkablesummary(loandata, title = "Summary Statistics for Loan Default Prediction")
